var tang,__awaiter=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function s(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((r=r.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(c){s=[6,c],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},__values=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},__read=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(s){o={error:s}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},__extends=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),__spreadArray=this&&this.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||(r||(r=Array.prototype.slice.call(e,0,o)),r[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))};(function(t){t.playerId=void 0,t.createAt=void 0,t.userInfo=void 0,t.isWeekLogin=!1,t.authed=!1})(tang||(tang={})),function(t){t.auth=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,t.rpc.client.callAPI(t.Cmd.AUTH,{platform:t.options.platform,info:e})]})})}}(tang||(tang={})),function(t){(t.user||(t.user={})).updateInfo=function(e){return __awaiter(this,void 0,void 0,function(){var n,r;return __generator(this,function(o){switch(o.label){case 0:return n={info:e},[4,t.rpc.callAPI(t.Cmd.USER_UPDATE_INFO,n)];case 1:if((r=o.sent()).code)return[2,r];t.userInfo=r.body.user,t.isWeekLogin=!r.body.user.authed;try{t.localPrefs.setItem("tang.userInfo",JSON.stringify(t.userInfo))}catch(i){}return[2,r]}})})}}(tang||(tang={})),function(t){(function(t){t.AUTH="login/auth",t.USER_UPDATE_INFO="user/updateInfo",t.LEADERBOARD_UPLOAD="leaderboard/upload",t.LEADERBOARD_GET_RANKS="leaderboard/getRanks",t.STORAGE_SAVE="storage/save",t.STORAGE_LOAD="storage/load",t.STORAGE_UPDATE_OPEN_DATA="storage/updateOpenData",t.STORAGE_GET_OPEN_DATA="storage/getOpenData"})(t.Cmd||(t.Cmd={}))}(tang||(tang={})),function(t){(function(e){e.save=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return e.ver=++t.player.ver,t.options.neverSaveLocal||t.player.$saveToLocal("ver"),[2,t.rpc.callAPI(t.Cmd.STORAGE_SAVE,{data:e})]})})},e.load=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,t.rpc.callAPI(t.Cmd.STORAGE_LOAD,{keys:e})]})})},e.updateOpenData=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,t.rpc.callAPI(t.Cmd.STORAGE_UPDATE_OPEN_DATA,e)]})})},e.getOpenData=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,t.rpc.callAPI(t.Cmd.STORAGE_GET_OPEN_DATA,e)]})})},e.lock=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,t.rpc.callAPI("storage/lock",e)]})})},e.unlock=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,t.rpc.callAPI("storage/unlock",e)]})})}})(t.storage||(t.storage={}))}(tang||(tang={})),function(t){var e=function(){function e(){}return e.prototype.toJSON=function(){var e=this,n={};return this.constructor.properties.forEach(function(r,o){var i,a;if(r.type==t.DataTypeEnum.BASIC&&(n[o]=e[o]),r.type==t.DataTypeEnum.CLASS&&(n[o]=e[o].toJSON()),r.type==t.DataTypeEnum.ARRAY)if(r.classType){n[o]=[];try{for(var s=__values(e[o]),c=s.next();!c.done;c=s.next()){var u=c.value;n[o].push(u.toJSON())}}catch(h){i={error:h}}finally{try{c&&!c.done&&(a=s.return)&&a.call(s)}finally{if(i)throw i.error}}}else n[o]=toJS(e[o]);else r.type==t.DataTypeEnum.MAP?r.classType?(n[o]={},e[o].forEach(function(t,e){n[o][e]=t.toJSON()})):n[o]=e[o]:r.type===t.DataTypeEnum.DATE&&(n[o]=e[o].toString())}),n},e.prototype.createProperty=function(e){var n=this.constructor.properties.get(e);if(n.type==t.DataTypeEnum.CLASS)return new n.classType;if(n.type==t.DataTypeEnum.ARRAY)return new Array;if(n.type==t.DataTypeEnum.MAP)return new Map;if(n.type==t.DataTypeEnum.DATE)return new Date;var r=typeof this[e];return"string"===r?"":"boolean"!==r&&0},e.prototype.reset=function(){var e,n,r=this.constructor.properties;try{for(var o=__values(r),i=o.next();!i.done;i=o.next()){var a=__read(i.value,2),s=a[0],c=a[1];c.type===t.DataTypeEnum.BASIC||c.type===t.DataTypeEnum.DATE?this[s]=this.createProperty(s):c.type===t.DataTypeEnum.CLASS?this[s]&&this[s].reset():c.type===t.DataTypeEnum.ARRAY?(this[s]||(this[s]=this.createProperty(s)),this[s]&&(this[s].length=0)):c.type===t.DataTypeEnum.MAP&&(this[s]||(this[s]=this.createProperty(s)),this[s]&&this[s].clear())}}catch(u){e={error:u}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}},e.prototype.clone=function(){var e,n,r=new(Object.getPrototypeOf(this).constructor),o=this.constructor.properties,i=function(e,n){if(n.type===t.DataTypeEnum.BASIC)r[e]=a[e];else if(n.type===t.DataTypeEnum.CLASS)a[e]?r[e]=a[e].clone():r[e]=a.createProperty(e);else if(n.type===t.DataTypeEnum.ARRAY)r[e]=a.createProperty(e),a[e]&&a[e].forEach(function(t){return r[e].push(t)});else if(n.type===t.DataTypeEnum.MAP)r[e]=a.createProperty(e),a[e]&&a[e].forEach(function(t,n){return r[e].set(n,t)});else if(n.type===t.DataTypeEnum.DATE){var o=a.createProperty(e);o.setTime(a[e].getTime()),r[e]=o}},a=this;try{for(var s=__values(o),c=s.next();!c.done;c=s.next()){var u=__read(c.value,2);i(u[0],u[1])}}catch(h){e={error:h}}finally{try{c&&!c.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}return r},e.prototype.setValue=function(e){var n,r,o=this.constructor.properties;for(var i in e){var a=e[i],s=o.get(i);if(s)if(s.type==t.DataTypeEnum.BASIC)this[i]=a;else if(s.type==t.DataTypeEnum.CLASS)this[i]||(this[i]=this.createProperty(i)),this[i].setValue(a);else if(s.type==t.DataTypeEnum.ARRAY)if(this[i],null==a)this[i]=[];else if(s.classType){this[i]=[];try{for(var c=(n=void 0,__values(a)),u=c.next();!u.done;u=c.next()){var h=u.value;if((d=new s.classType).setValue)d.setValue(h);else for(var f in h)d[f]=a[f];this[i].push(d)}}catch(p){n={error:p}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}}else this[i]=a;else if(s.type==t.DataTypeEnum.MAP){var l=this[i];if(null==a)l.clear();else for(var f in a)if(+f+""===f&&(f=+f),null==a[f])l.delete(f);else if(l.has(f))s.classType?(d=l.get(f)).setValue(a[f]):l.set(f,a[f]);else{var d;s.classType?((d=new s.classType).setValue(a[f]),l.set(f,d)):l.set(f,a[f])}}else s.type===t.DataTypeEnum.DATE&&(this[i],a instanceof Array?this[i]=new Date(1e3*a[0]+a[1]/1e6):this[i]=new Date(a))}},e}();t.DataBase=e}(tang||(tang={})),function(t){t.getDataType=function(t,e){t.constructor.properties||(t.constructor.properties=new Map);var n=t.constructor.properties,r=n.get(e);return r||(r={},n.set(e,r)),r},t.type=function(e,n){return function(r,o){var i=t.getDataType(r,o);i.type=e,n&&(i.classType=n)}},t.dataClass=function(e){return function(n,r){t.getDataType(n,r).classType=e}};var e="ignore_properties";t.ignore=function(t,n){t.constructor[e]||(t.constructor[e]=[]),t.constructor[e].push(n)},t.autoMarkProperties=function(n){if(!n.constructor.autoMarked){n.constructor.autoMarked=!0;var r=n instanceof t.Player;r&&(n.constructor[t.syncKey]=[]);var o=n.constructor[e];for(var i in n){var a=i.charAt(0);if(a&&"$"!==a&&"_"!==a){var s=n[i],c=typeof s;if("number"===c||"string"===c||"boolean"===c)(u=t.getDataType(n,i)).type=t.DataTypeEnum.BASIC,r&&n.constructor[t.syncKey].push(i);else if("object"===c){var u=t.getDataType(n,i);if(s instanceof Date?u.type=t.DataTypeEnum.DATE:t.isArrayLike(s)?u.type=t.DataTypeEnum.ARRAY:t.isMapLike(s)?u.type=t.DataTypeEnum.MAP:(u.type=t.DataTypeEnum.CLASS,u.classType=s.constructor),o&&-1!==o.indexOf(i))continue;r&&n.constructor[t.syncKey].push(i)}}}}},t.autoMark=function(e){var n=new e;t.autoMarkProperties(n)}}(tang||(tang={})),function(t){(function(t){t[t.BASIC=0]="BASIC",t[t.CLASS=1]="CLASS",t[t.ARRAY=2]="ARRAY",t[t.MAP=3]="MAP",t[t.DATE=4]="DATE"})(t.DataTypeEnum||(t.DataTypeEnum={}))}(tang||(tang={})),function(t){t.sync=function(n,r){if(!("ver"===r||n instanceof e))throw new Error("tang.sync \u53ea\u80fd\u4fee\u9970 tang.Player \u5bf9\u8c61");var o=n.constructor[t.syncKey]||[];o.push(r),n.constructor[t.syncKey]=o},t.syncKey="player_sync_list";var e=function(e){function n(){var n=e.call(this)||this;if(n.ver=0,n.$loaded=!1,t.player)throw new Error("player can only create once");return t.player=n,n}return __extends(n,e),n.prototype.save=function(e){return void 0===e&&(e=this.getKeys()),__awaiter(this,void 0,void 0,function(){var n,r,o,i,a,s;return __generator(this,function(c){switch(c.label){case 0:if(!this.ensureLoaded())return[2];for(n={},r=0;r<e.length;++r){if(o=e[r],i=void 0,-1!=o.indexOf("."))for(a=o.split("."),i=this[a[0]],s=1;s<a.length&&void 0!==i;s++)i=t.isMapLike(i)?i.get(a[s]):i[a[s]];else i=this[o];n[o]=t.toJson(i)}return[4,t.storage.save(n)];case 1:return[2,c.sent()]}})})},n.prototype.getKeys=function(){return this.constructor[t.syncKey]},n.prototype.load=function(e){return void 0===e&&(e=this.getKeys()),__awaiter(this,void 0,void 0,function(){var n,r;return __generator(this,function(o){switch(o.label){case 0:return[4,t.storage.load.apply(t.storage,__spreadArray([],__read(e),!1))];case 1:return 0===(n=o.sent()).code&&(r=n.body,this.setValue(r),this.$loaded=!0),[2,n]}})})},n.prototype.ensureLoaded=function(){return!!this.$loaded||(console.error("\u6ca1\u6709\u8bfb\u53d6\u8fc7\u6570\u636e\uff0c\u7981\u6b62\u5b58\u50a8"),!1)},n.prototype.$saveToLocal=function(e){if(this.ensureLoaded()){var n={},r=this[e];null!=r&&(n[e]=t.toJson(r),t.local.set(n))}},n.prototype.saveToLocal=function(e){if(void 0===e&&(e=this.getKeys()),!this.ensureLoaded())return!1;for(var n={},r=e,o=r.length,i=0;i<o;++i){var a=r[i],s=this[a];null!=s&&(n[a]=t.toJson(s))}return t.local.set(n)},n.prototype.loadFromLocal=function(){if(!t.local.isValidate())return!1;var e=t.local.get();return this.setValue(e),this.$loaded=!0,!0},n}(t.DataBase);t.Player=e}(tang||(tang={})),function(t){t.toJson=function e(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"symbol":return n;case"object":if(!n)return null;if(n instanceof Date)return n.toString();if(t.isArrayLike(n)){for(var r=[],o=0;o<n.length;o++)r[o]=e(n[o]);return r}if(t.isMapLike(n)){var i={};return n.forEach(function(t,n){i[n]=e(t)}),i}if(n instanceof t.DataBase){var a={};return n.constructor.properties.forEach(function(t,r){a[r]=e(n[r])}),a}if("function"==typeof n.toJson)return n.toJson();var s={};for(var c in n)s[c]=e(n[c]);return s;default:return}}}(tang||(tang={})),function(t){(function(e){e.getOne=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,t.rpc.callAPINoAuth("tool/dynamicConfig/getOne",{id:e})]})})},e.getSome=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,t.rpc.callAPINoAuth("tool/dynamicConfig/getSome",{ids:e})]})})}})(t.dynamicconfig||(t.dynamicconfig={}))}(tang||(tang={})),function(t){(function(t){t.DEBUG="debug",t.HORTOR="hortor",t.HORTOR_TT="hortor-tt",t.HORTOR_NATIVE="hortor-native",t.HORTOR_MIX="hortor-mix"})(t.PlatformEnum||(t.PlatformEnum={}))}(tang||(tang={})),function(t){t.startup=function(e){if(t.options)throw new Error("tang.startup can only call once");var n={urlRoot:"https://test-htg.hortorgames.com/",timeout:5e3,resendMaxTimes:3,resendInterval:1e3};if(e)for(var r in e.urlRoot&&!e.urlRoot.endsWith("/")&&(e.urlRoot=e.urlRoot+"/"),e)n[r]=e[r];t.options=n,t.rpc.baseParams.gameId=e.gameId,t.rpc.client=new t.rpc.HttpClient,t.local.read();try{var o=t.localPrefs.getItem("tang.userInfo"),i=JSON.parse(o);i&&i.id&&(t.playerId=i.id,t.userInfo=i,t.createAt=new Date(i.regTime))}catch(a){}return t.rpc.on(t.EventType.NET_AUTHED,function(e){var n=e.data.resp;t.playerId=n.body.user.id,t.createAt=n.body.user.regTime,t.userInfo=n.body.user,t.isWeekLogin=!n.body.user.authed,t.authed=!0;try{t.localPrefs.setItem("tang.userInfo",JSON.stringify(t.userInfo))}catch(e){}}),new Promise(function(t){t()})}}(tang||(tang={}));try{window.tang=tang}catch(e){}(function(t){var e=[],n=function(){function n(){this.eventMap={}}return n.prototype.on=function(t,e,n){this.$on(t,e,n)},n.prototype.once=function(t,e,n){this.$on(t,e,n,!0)},n.prototype.$on=function(t,e,n,r){var o=this.eventMap,i=o[t];i||(i=o[t]=[]),this.$insertEventBin(i,t,e,n,r)},n.prototype.$insertEventBin=function(t,e,n,r,o){for(var i=t.length,a=0;a<i;a++){var s=t[a];if(s.listener==n&&s.thisObject==r&&s.target==this)return}var c={type:e,listener:n,thisObject:r,target:this,dispatchOnce:!!o};t.push(c)},n.prototype.off=function(t,e,n){var r=this.eventMap,o=r[t];o&&(this.$off(o,e,n),0==o.length&&delete r[t])},n.prototype.$off=function(t,e,n){for(var r=t.length,o=0;o<r;o++){var i=t[o];if(i.listener==e&&i.thisObject==n&&i.target==this)return t.splice(o,1),!0}return!1},n.prototype.willTrigger=function(t){return!!this.eventMap[t]},n.prototype.emit=function(t){this.$notifyListener(t)},n.prototype.$notifyListener=function(t){var n=this.eventMap[t.type];if(n){var r=n.length;if(0!=r){for(var o=e,i=0;i<r;i++)(a=n[i]).listener.call(a.thisObject,t),a.dispatchOnce&&o.push(a);for(;o.length;){var a;(a=o.pop()).target.off(a.type,a.listener,a.thisObject)}}}},n.prototype.emitWith=function(e,n){if(this.willTrigger(e)){var r=t.Event.create(t.Event,e,n);this.emit(r),t.Event.release(r)}},n}();t.EventDispatcher=n})(tang||(tang={})),function(t){(function(t){t.CHANGE="change",t.NET_AUTHED="net_authed",t.NET_SUCCESS="net_success",t.NET_ERROR="net_error",t.NET_COMPLETE="net_complete",t.SOCKET_DATA="socket_data"})(t.EventType||(t.EventType={}))}(tang||(tang={})),function(t){var e=function(){function t(t,e){this.type=t,this.data=e}return t.prototype.clean=function(){this.data=null},t.dispatchEvent=function(e,n,r){var o=t.create(t,n,r);e.emit(o),t.release(o)},t.create=function(t,e,n){var r;if(t.hasOwnProperty("eventPool")&&(r=t.eventPool),r||(r=t.eventPool=[]),r.length){var o=r.pop();return o.type=e,o.data=n,o}return new t(e,n)},t.release=function(t){t.clean(),Object.getPrototypeOf(t).constructor.eventPool.push(t)},t}();t.Event=e}(tang||(tang={})),function(t){(function(t){(function(t){t.joinChatRoom="im/joinChatRoom",t.leaveChatRoom="im/leaveChatRoom",t.sendChatRoomMsg="im/sendChatRoomMsg",t.keepInChatRoom="im/keepInChatRoom",t.updateChatRoomMemInfo="im/updateChatRoomMemInfo"})(t.CMDS||(t.CMDS={})),function(t){t.chatRoomMsg="im/chatRoomMsg",t.chatRoomMemJoined="im/chatRoomMemJoined",t.chatRoomMemLeft="im/chatRoomMemLeft",t.chatRoomMemUpdated="im/chatRoomMemUpdated"}(t.RESPS||(t.RESPS={}))})(t.im||(t.im={}))}(tang||(tang={})),function(t){(function(e){(function(t){t.asc="asc",t.desc="desc"})(e.SortType||(e.SortType={})),e.upload=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,t.rpc.callAPI(t.Cmd.LEADERBOARD_UPLOAD,e)]})})},e.getRanks=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,t.rpc.callAPI(t.Cmd.LEADERBOARD_GET_RANKS,e)]})})},e.getRanksByIds=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,t.rpc.callAPI("leaderboard/getRanksByIds",e)]})})}})(t.leaderboard||(t.leaderboard={}))}(tang||(tang={})),function(t){(function(t){(function(t){t.read=function(){var t;if(window.localStorage)try{t=window.localStorage.getItem("tang.data")}catch(e){console.error("get localStorage data error",e)}else console.error("do not find localStorage");return t},t.write=function(t){try{window.localStorage.setItem("tang.data",t)}catch(e){console.error("set localStorage data error",e)}},t.has=function(){return!!window.localStorage.getItem("tang.data")}})(t.debugFS||(t.debugFS={}))})(t.local||(t.local={}))}(tang||(tang={})),function(t){(function(t){(function(t){var n=window.wx||{},r=n.getFileSystemManager?n.getFileSystemManager():null,o="tang.bin";r&&(o=n.env.USER_DATA_PATH+"/"+o),t.read=function(){if(t.has()){var e=r.readFileSync(o);return bon.decode(new Uint8Array(e))}},t.remove=function(){try{r.unlinkSync(o)}catch(e){}},t.has=function(){try{return r.accessSync(o),!0}catch(e){return!1}}})(t.wxFS||(t.wxFS={}))})(t.local||(t.local={}))}(tang||(tang={})),function(t){(function(n){var r,o,i;n.read=function(){var t=(r=window.wx&&!n.debugFS.has()?n.wxStorage:n.debugFS).read();if(t)try{if(t.length>32){var a=t.length-32;i=t.slice(a),t=t.slice(0,a),o=JSON.parse(t)}else o={}}catch(e){o={}}else o={}},n.hasLocalData=function(){return r.has()},n.isValidate=function(){return!(!i||!o)&&md5(JSON.stringify(o)+t.options.secret)===i},n.get=function(){return o},n.set=function(t){if(t){for(var e in t)o[e]=t[e];return a()}return!1};var a=function(){var n;try{n=JSON.stringify(o)}catch(e){return!1}return n+=i=md5(n+t.options.secret),r.write(n),!0}})(t.local||(t.local={}))}(tang||(tang={})),function(t){(function(n){(function(r){var o=!1;r.read=function(){try{var i=t.localPrefs.getItem("tang.storage");if(i)return n.wxFS.remove(),i;var a=n.wxFS.read();if(n.wxFS.remove(),a){if(a.tang){var s=a.tang;if(delete a.tang,md5(JSON.stringify(a))!=s)return void(o=!0);if(a.userInfo){try{t.localPrefs.setItem("tang.userInfo",JSON.stringify(a.userInfo))}catch(e){return void(o=!0)}delete a.userInfo,delete a.createAt,delete a.playerId}a.authInfo&&delete a.authInfo;var c=JSON.stringify(a);return c+=md5(c+t.options.secret),r.write(c),c}return void(o=!0)}return void(o=!0)}catch(e){return void(o=!0)}},r.write=function(e){t.localPrefs.setItem("tang.storage",e)},r.has=function(){if(o)return!1;try{if(t.localPrefs.getItem("tang.storage"))return!0}catch(e){return!1}}})(n.wxStorage||(n.wxStorage={}))})(t.local||(t.local={}))}(tang||(tang={})),function(t){(function(e){var n=function(n){function r(){var t=n.call(this)||this;return t.frameMsgs=[],t.seed=0,t.startSyncTime=0,window.obe=t,t.addListener(),t}return __extends(r,n),r.prototype.sendFrame=function(t,e){this.sendMsg(t,e)},r.prototype.sendMsg=function(n,r){n.roomId=this.info.id,r&&(n.data=r),t.ws.send({cmd:e.room.CMDS.msg,hint:this.info.id,body:n})},r.prototype.startFrameSync=function(n){n.roomId=this.info.id,n.frameRate=Math.min(~~n.frameRate||10,60),t.ws.send({cmd:e.room.CMDS.startFrameSync,hint:this.info.id,body:n})},r.prototype.stopFrameSync=function(){t.ws.send({cmd:e.room.CMDS.stopFrameSync,hint:this.info.id,body:{roomId:this.info.id}})},r.prototype.sendFrameMsg=function(n){n.roomId=this.info.id,t.ws.send({cmd:e.room.CMDS.frameMsg,hint:this.info.id,body:n})},r.prototype.end=function(){t.ws.send({cmd:e.room.CMDS.end,hint:this.info.id,body:{roomId:this.info.id}})},r.create=function(n){return __awaiter(this,void 0,void 0,function(){var o,i;return __generator(this,function(a){switch(a.label){case 0:return[4,t.ws.sendAsync({cmd:e.room.CMDS.create,body:n})];case 1:return(o=a.sent()).code?[2,null]:((i=new r).info=o.decBody,[2,i])}})})},r.prototype.addListener=function(){t.ws.on(e.room.RESPS.join,this.onRoomJoin,this),t.ws.on(e.room.RESPS.lock,this.onRoomLock,this),t.ws.on(e.room.RESPS.unlock,this.onRoomUnlock,this),t.ws.on(e.room.RESPS.leave,this.onRoomLeave,this),t.ws.on(e.room.RESPS.startFrameSync,this.onStartFrameSync,this),t.ws.on(e.room.RESPS.stopFrameSync,this.onStopFrameSync,this),t.ws.on(e.room.RESPS.frameMsg,this.onFrameMsg,this),t.ws.on(e.room.RESPS.updateMemberInfo,this.onUpdateMemberInfo,this)},r.prototype.removeListener=function(){t.ws.off(e.room.RESPS.join,this.onRoomJoin,this),t.ws.off(e.room.RESPS.lock,this.onRoomLock,this),t.ws.off(e.room.RESPS.unlock,this.onRoomUnlock,this),t.ws.off(e.room.RESPS.leave,this.onRoomLeave,this),t.ws.off(e.room.RESPS.startFrameSync,this.onStartFrameSync,this),t.ws.off(e.room.RESPS.stopFrameSync,this.onStopFrameSync,this),t.ws.off(e.room.RESPS.frameMsg,this.onFrameMsg,this),t.ws.off(e.room.RESPS.updateMemberInfo,this.onUpdateMemberInfo,this)},r.prototype.dispose=function(){delete this.info,this.removeListener()},r.prototype.shouldExecute=function(t){if(!t.decBody)return!1;var e=t.decBody.id||t.decBody.roomId;return!(!e||e!==this.info.id&&(this.leave({roomId:e}),1))},r.prototype.onStartFrameSync=function(n){this.shouldExecute(n)&&(this.startSyncTime=t.TimeUtil.serverTime,this.seed=this.info.createAt,this.rand=new t.SeedRandom(this.seed),this.emitWith(e.FrameSyncEnvetType.START))},r.prototype.onStopFrameSync=function(t){this.shouldExecute(t)&&this.emitWith(e.FrameSyncEnvetType.STOP)},r.prototype.onFrameMsg=function(t){this.shouldExecute(t)&&(this.frameMsgs.push(t.decBody),this.emitWith(e.FrameSyncEnvetType.MSG))},r.prototype.onRoomJoin=function(e){if(this.shouldExecute(e)){var n=e.decBody.members;for(var r in n)this.info.members[r]=n[r];this.emitWith(t.EventType.CHANGE)}},r.prototype.onRoomLock=function(e){this.shouldExecute(e)&&(this.info.locked=!0,this.emitWith(t.EventType.CHANGE))},r.prototype.onRoomUnlock=function(e){this.shouldExecute(e)&&(this.info.locked=!1,this.emitWith(t.EventType.CHANGE))},r.prototype.onRoomLeave=function(e){if(this.shouldExecute(e)){var n=e.decBody.members;for(var r in n)delete this.info.members[r];e.decBody.owner&&(this.info.owner=e.decBody.owner),this.emitWith(t.EventType.CHANGE)}},r.prototype.onUpdateMemberInfo=function(e){if(this.shouldExecute(e)){var n=e.decBody.members;for(var r in n)this.info.members[r]=n[r];this.emitWith(t.EventType.CHANGE)}},r.join=function(n){return __awaiter(this,void 0,void 0,function(){var o,i;return __generator(this,function(a){switch(a.label){case 0:return[4,t.ws.sendAsync({cmd:e.room.CMDS.join,hint:n.roomId,body:n})];case 1:return(o=a.sent()).code?[2,null]:((i=new r).info=o.decBody,[2,i])}})})},r.prototype.lock=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(n){switch(n.label){case 0:return[4,t.ws.sendAsync({cmd:e.room.CMDS.lock,hint:this.info.id,body:{roomId:this.info.id}})];case 1:return 0===n.sent().code?[2,!0]:[2,!1]}})})},r.prototype.unlock=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(n){switch(n.label){case 0:return[4,t.ws.sendAsync({cmd:e.room.CMDS.unlock,hint:this.info.id,body:{roomId:this.info.id}})];case 1:return 0===n.sent().code?[2,!0]:[2,!1]}})})},r.prototype.ping=function(){t.ws.send({cmd:e.room.CMDS.ping,hint:this.info.id,body:{roomId:this.info.id}})},r.prototype.dismiss=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(n){switch(n.label){case 0:return[4,t.ws.sendAsync({cmd:e.room.CMDS.dismiss,hint:this.info.id,body:{roomId:this.info.id}})];case 1:return 0===n.sent().code?[2,!0]:[2,!1]}})})},r.prototype.leave=function(n){return void 0===n&&(n={}),__awaiter(this,void 0,void 0,function(){return __generator(this,function(r){switch(r.label){case 0:return n.roomId=n.roomId||this.info.id,[4,t.ws.sendAsync({cmd:e.room.CMDS.leave,hint:n.roomId,body:n})];case 1:return 0===r.sent().code?[2,!0]:[2,!1]}})})},r.prototype.regTimer=function(n){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(r){switch(r.label){case 0:return n.roomId=this.info.id,[4,t.ws.sendAsync({cmd:e.room.CMDS.regTimer,hint:this.info.id,body:n})];case 1:return 0===r.sent().code?[2,!0]:[2,!1]}})})},r.prototype.updateCustom=function(n){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(r){switch(r.label){case 0:return n.roomId=this.info.id,[4,t.ws.sendAsync({cmd:e.room.CMDS.updateCustom,hint:this.info.id,body:n})];case 1:return 0===r.sent().code?[2,!0]:[2,!1]}})})},r.prototype.updateMemberInfo=function(n){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(r){switch(r.label){case 0:return n.roomId=this.info.id,[4,t.ws.sendAsync({cmd:e.room.CMDS.updateMemberInfo,hint:this.info.id,body:n})];case 1:return 0===r.sent().code?[2,!0]:[2,!1]}})})},r.findFree=function(n){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(r){switch(r.label){case 0:return[4,t.ws.sendAsync({cmd:e.room.CMDS.findFree,body:n})];case 1:return[2,r.sent().decBody||[]]}})})},r}(t.EventDispatcher);e.Room=n})(t.OBE||(t.OBE={}))}(tang||(tang={})),function(t){(function(t){(function(t){t.MATCH="match",t.FREE="free"})(t.RoomType||(t.RoomType={}))})(t.OBE||(t.OBE={}))}(tang||(tang={})),function(t){(function(t){(function(t){t.START="frameSyncStart",t.STOP="frameSyncStop",t.MSG="frameSyncMsg"})(t.FrameSyncEnvetType||(t.FrameSyncEnvetType={})),(t.MsgTarget||(t.MsgTarget={})).ALL="all",(t.FrameTarget||(t.FrameTarget={})).ALL="all"})(t.OBE||(t.OBE={}))}(tang||(tang={})),function(t){(function(t){(function(t){(function(t){t.create="room/create",t.join="room/join",t.msg="room/msg",t.startFrameSync="room/startFrameSync",t.stopFrameSync="room/stopFrameSync",t.frameMsg="room/frameMsg",t.end="room/end",t.lock="room/lock",t.unlock="room/unlock",t.ping="room/ping",t.dismiss="room/ping",t.leave="room/leave",t.regTimer="room/regTimer",t.updateCustom="room/updateCustom",t.updateMemberInfo="room/updateMemberInfo",t.findFree="room/findFree"})(t.CMDS||(t.CMDS={})),function(t){t.start="room/start",t.join="room/join",t.lock="room/lock",t.unlock="room/unlock",t.leave="room/leave",t.startFrameSync="room/startFrameSync",t.stopFrameSync="room/stopFrameSync",t.frameMsg="room/frameMsg",t.updateMemberInfo="room/updateMemberInfo",t.timerFire="room/timerFire"}(t.RESPS||(t.RESPS={}))})(t.room||(t.room={}))})(t.OBE||(t.OBE={}))}(tang||(tang={})),function(t){(function(e){var n=function(){function n(){}return n.create=function(r){return __awaiter(this,void 0,void 0,function(){var o,i;return __generator(this,function(a){switch(a.label){case 0:return[4,t.ws.sendAsync({cmd:e.team.CMDS.create,body:r})];case 1:return(o=a.sent()).code?[2,null]:((i=new n).info=o.decBody,[2,i])}})})},n.prototype.match=function(n,r){this.matchCallback=r,this.addListener(),n.teamId=this.info.id,t.ws.send({cmd:e.team.CMDS.matchStart,body:n})},n.prototype.onMatch=function(t){for(var n=t.decBody,r=!1,o=0;o<n.teams.length;++o)if(n.teams[o].id===this.info.id){r=!0;break}if(r)if(this.removeListener(),0==t.code){if(this.matchCallback){var i=this.matchCallback;this.matchCallback=null;var a=new e.Room;a.info=n,i.call(null,null,a)}if(this.matchStartResolve){var s=this.matchStartResolve;this.matchStartResolve=null;var c=new e.Room;c.info=n,s({err:null,room:c})}}else this.onMatchError(t.code)},n.prototype.addListener=function(){t.ws.on(e.room.RESPS.start,this.onMatch,this),t.ws.on(e.team.RESPS.matchStart,this.onMatchStart,this),t.ws.on(e.team.RESPS.matchTimeout,this.onMatchTimeout,this)},n.prototype.removeListener=function(){t.ws.off(e.room.RESPS.start,this.onMatch,this),t.ws.off(e.team.RESPS.matchStart,this.onMatchStart,this),t.ws.off(e.team.RESPS.matchTimeout,this.onMatchTimeout,this)},n.prototype.onMatchTimeout=function(){this.onMatchError(t.rpc.ErrorCode.TIMEOUT)},n.prototype.onMatchError=function(t){if(this.removeListener(),this.matchCallback){var e=this.matchCallback;this.matchCallback=null,e.call(null,t)}if(this.matchStartResolve){var n=this.matchStartResolve;this.matchStartResolve=null,n({err:t,room:null})}},n.prototype.onMatchStart=function(t){0!==t.code&&this.onMatchError(t.code)},n.prototype.matchStart=function(n){var r=this;return new Promise(function(o){r.matchStartResolve=o,r.addListener(),n.teamId=r.info.id,t.ws.send({cmd:e.team.CMDS.matchStart,body:n})})},n.prototype.matchCancel=function(n){return __awaiter(this,void 0,void 0,function(){var r;return __generator(this,function(o){switch(o.label){case 0:return n.teamId=this.info.id,[4,t.ws.sendAsync({cmd:e.team.CMDS.matchCancel,body:n})];case 1:return r=o.sent(),this.matchStartResolve=null,0===r.code?(this.removeListener(),this.onMatchError(t.rpc.ErrorCode.CANCELED),[2,!0]):[2,!1]}})})},n}();e.Team=n})(t.OBE||(t.OBE={}))}(tang||(tang={})),function(t){(function(t){(function(t){(function(t){t.create="team/create",t.matchStart="match/start",t.matchCancel="match/cancel"})(t.CMDS||(t.CMDS={})),function(t){t.matchStart="match/start",t.matchTimeout="match/timeout"}(t.RESPS||(t.RESPS={}))})(t.team||(t.team={}))})(t.OBE||(t.OBE={}))}(tang||(tang={})),function(t){(function(e){var n=this;(function(t){t.active="active",t.block="block"})(e.GoodsStatus||(e.GoodsStatus={})),function(t){t.unlimit="unlimit",t.period="period"}(e.GoodsEffectiveTimeType||(e.GoodsEffectiveTimeType={})),e.getGoodsList=function(){return __awaiter(n,void 0,void 0,function(){return __generator(this,function(){return[2,t.rpc.callAPI("pay/getGoodsList",{})]})})},e.createOrder=function(e){return __awaiter(n,void 0,void 0,function(){return __generator(this,function(){return[2,t.rpc.callAPI("pay/createOrder",e)]})})},e.finishOrder=function(e){return __awaiter(n,void 0,void 0,function(){return __generator(this,function(){return[2,t.rpc.callAPI("pay/finishOrder",e)]})})},e.getSuccessOrder=function(){return __awaiter(n,void 0,void 0,function(){return __generator(this,function(){return[2,t.rpc.callAPI("pay/getSuccessOrder",{})]})})};var r,o=[0,1,5,10,20,40,80],i=0,a=function(){return __awaiter(n,void 0,void 0,function(){var t,n;return __generator(this,function(s){switch(s.label){case 0:return[4,r=e.getSuccessOrder()];case 1:return t=s.sent(),r=void 0,n=!1,t.code?console.log("\u68c0\u67e5\u6210\u529f\u8ba2\u5355\u9519\u8bef"):t.body&&t.body.length&&(n=!0,e.onOrderSuccess&&t.body.forEach(function(t){e.onOrderSuccess(t)})),n||++i<o.length&&setTimeout(a,1e3*o[i]),[2]}})})};e.startCheckOrderSuccess=function(){r?i=-1:(i=0,a())}})(t.pay||(t.pay={}))}(tang||(tang={})),function(t){(function(e){(function(t){t.PUBLIC_R="r",t.PUBLIC_RW="rw",t.PRIVATE="-"})(e.ACL||(e.ACL={})),e.insertOne=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,t.rpc.callAPI("publicStorage/insertOne",e)]})})},e.findOneByIndex=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,t.rpc.callAPI("publicStorage/findOneByIndex",e)]})})},e.findByIndex=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,t.rpc.callAPI("publicStorage/findByIndex",e)]})})},e.updateOneByIndex=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,t.rpc.callAPI("publicStorage/updateOneByIndex",e)]})})},e.findOneAndUpdateByIndex=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,t.rpc.callAPI("publicStorage/findOneAndUpdateByIndex",e)]})})}})(t.publicstorage||(t.publicstorage={}))}(tang||(tang={})),function(t){(t.rpc||(t.rpc={})).baseParams={}}(tang||(tang={})),function(t){(function(e){var n=window.requestAnimationFrame||function(t){return setTimeout(t,16)},r=function(){function r(){var e=this;this._seq=0,this._queue=[],this._busy=!1,this._dispatcher=new t.EventDispatcher,this.fatalError=0,this._sm=new t.StateMachine,this._sm.registerState({state:0,update:function(){return e.onReadyUpdate()}}),this._sm.registerState({state:1,enter:function(){return e.onAuthingEnter()}}),this._sm.registerState({state:2,update:function(){return e.onRunningUpdate()}}),this._sm.changeState(0),n(function(){return e.update()})}return r.prototype.update=function(){var t=this;this._sm.update(),n(function(){return t.update()})},r.prototype.callAPI=function(e,n){return __awaiter(this,void 0,void 0,function(){var r;return __generator(this,function(){return r={api:e,req:n,reqTime:Date.now()},e===t.Cmd.AUTH?this._queue.unshift(r):this._queue.push(r),[2,new Promise(function(t){r.resolve=t})]})})},r.prototype.callAPINoAuth=function(t,e){return __awaiter(this,void 0,void 0,function(){var n,r=this;return __generator(this,function(){return n={api:t,req:e,reqTime:Date.now()},[2,new Promise(function(t){return __awaiter(r,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return n.resolve=t,[4,this.doCallAPI(n)];case 1:return e.sent(),this.onResult(n),[2]}})})})]})})},r.prototype.onReadyUpdate=function(){if(this._queue.length>0&&this._queue[0].api==t.Cmd.AUTH)this._sm.changeState(1);else for(var n=Date.now();this._queue.length>0;){var r=this._queue[0];if(!(n-r.reqTime>12e4))break;this._queue.shift(),r.resp={code:e.ErrorCode.NEED_AUTH},this.onResult(r)}},r.prototype.onAuthingEnter=function(){return __awaiter(this,void 0,void 0,function(){var t,n;return __generator(this,function(r){switch(r.label){case 0:return(t=this._queue.shift()).req?[3,1]:(t.resp={code:e.ErrorCode.AUTH_ERROR},[3,3]);case 1:return t.seq=++this._seq,n=t,[4,this.doCallAPI(t)];case 2:n.resp=r.sent(),r.label=3;case 3:return this.onResult(t),t.resp.code?(this._sm.changeState(0),[2]):(this.authResult=t.resp,this.fatalError=0,this.token=t.resp.body.token,this.playerId=t.resp.body.user.id,this._sm.changeState(2),[2])}})})},r.prototype.onRunningUpdate=function(){return __awaiter(this,void 0,void 0,function(){var r,o,i=this;return __generator(this,function(a){switch(a.label){case 0:if(this._busy||0==this._queue.length)return[2];this._busy=!0,a.label=1;case 1:return a.trys.push([1,,6,7]),void 0===(r=this._queue.shift())?[2]:r.api!=t.Cmd.AUTH?[3,2]:(r.resp=this.authResult,[3,5]);case 2:return this.fatalError?(r.resp={code:this.fatalError},[3,5]):[3,3];case 3:return r.seq=++this._seq,[4,this.doCallAPI(r)];case 4:(o=a.sent()).code!=e.ErrorCode.SIGN_ERROR&&o.code!=e.ErrorCode.VERIFY_ERROR||(this.fatalError=o.code,delete this.authResult,this._sm.changeState(0)),a.label=5;case 5:return this.onResult(r),[3,7];case 6:return n(function(){return i._busy=!1}),[7];case 7:return[2]}})})},r.prototype.onResult=function(e){e.resp.code?this._dispatcher.emitWith(t.EventType.NET_ERROR,e):(e.api==t.Cmd.AUTH&&this._dispatcher.emitWith(t.EventType.NET_AUTHED,e),this._dispatcher.emitWith(t.EventType.NET_SUCCESS,e)),this._dispatcher.emitWith(t.EventType.NET_COMPLETE,e),e.resolve(e.resp)},r.prototype.on=function(t,e,n){this._dispatcher.on(t,e,n)},r.prototype.off=function(t,e,n){this._dispatcher.off(t,e,n)},r.prototype.once=function(t,e,n){this._dispatcher.once(t,e,n)},r}();e.Client=r})(t.rpc||(t.rpc={}))}(tang||(tang={})),function(t){(function(t){(function(t){t[t.TIMEOUT=-2]="TIMEOUT",t[t.UNKNOWN=-1]="UNKNOWN",t[t.NEED_AUTH=-3]="NEED_AUTH",t[t.AUTH_ERROR=-4]="AUTH_ERROR",t[t.CANCELED=-5]="CANCELED",t[t.SKIP=-6]="SKIP",t[t.VERIFY_ERROR=-10004]="VERIFY_ERROR",t[t.SIGN_ERROR=-10005]="SIGN_ERROR",t[t.PLAYER_DATA_VERSION_ERROR=-30001]="PLAYER_DATA_VERSION_ERROR"})(t.ErrorCode||(t.ErrorCode={}))})(t.rpc||(t.rpc={}))}(tang||(tang={})),function(t){(function(n){var r=function(r){function o(){var e=r.call(this)||this;return e._retry=0,e._timeout=1e4,e._retryInterval=500,e._timeout=t.options.timeout,e._retry=t.options.resendMaxTimes,e._retryInterval=t.options.resendInterval,e._url=t.options.urlRoot,e._url.endsWith("/")||(e._url+="/"),e}return __extends(o,r),o.prototype.doCallAPI=function(e){return __awaiter(this,void 0,void 0,function(){var r,o,i,a,s,c,u,h,f,l,d,p,m,_,y,g,v;return __generator(this,function(S){switch(S.label){case 0:S.trys.push([0,9,,10]),o={seq:e.seq,gameId:t.options.gameId},this.playerId&&(o.playerId=this.playerId,o.token=this.token),e.req&&(o.body=e.req),t.options.debug&&console.log("%c>>>> \u53d1\u9001 [".concat(e.api,"]"),"color:#00af00;font-weight:bold;",o),i=bon.encode(o),a=t.lz4XorEncode(i),e.reqData=a,(s=md5.create()).update(a),s.update(t.options.secret),e.sign=s.hex(),c=t.options.resendMaxTimes,S.label=1;case 1:return c-- >=0?c<this._retry-1?[4,t.sleep(this._retryInterval)]:[3,3]:[3,8];case 2:S.sent(),t.options.debug&&console.log("%c>>>> \u91cd\u8bd5 [".concat(e.api,"]"),"color:#afaf00;font-weight:bold;",this._retry-c-1),S.label=3;case 3:u=new XMLHttpRequest,S.label=4;case 4:return S.trys.push([4,6,,7]),h=t.sleep(this._timeout),f=this._post(u,e),[4,Promise.race([h,f])];case 5:return(l=S.sent())!==u?(r={code:n.ErrorCode.TIMEOUT,error:"http timeout"},u.abort(),[3,1]):200!=u.status?(r={code:n.ErrorCode.UNKNOWN,error:u.errMsg||u.statusText},[3,1]):(d=l.response)&&d instanceof ArrayBuffer?(d=new Uint8Array(d),p=u.getResponseHeader("Sign")||u.getResponseHeader("sign")||u.getResponseHeader("SIGN"),(m=md5.create()).update(d),m.update(t.options.secret),m.hex()!==p?(r={},t.options.debug&&(_=t.lz4XorDecode(d),r=bon.decode(_)),r.code=n.ErrorCode.SIGN_ERROR,r.error="\u7b7e\u540d\u6821\u9a8c\u9519\u8bef",[3,8]):(y=t.lz4XorDecode(d),r=bon.decode(y),[3,8])):(r={code:n.ErrorCode.UNKNOWN,error:"\u54cd\u5e94\u6570\u636e\u7c7b\u578b\u9519\u8bef"},[3,8]);case 6:return g=S.sent(),console.error(g),r={code:n.ErrorCode.UNKNOWN,error:"\u672a\u77e5\u9519\u8bef"+g},[3,7];case 7:return[3,1];case 8:return[3,10];case 9:return v=S.sent(),console.log(v),r={code:n.ErrorCode.UNKNOWN,error:"\u672a\u77e5\u9519\u8bef"+v},[3,10];case 10:return r||(r={code:n.ErrorCode.UNKNOWN,error:"\u672a\u77e5\u9519\u8bef"}),r.code||(r.code=0),r.time&&Date.now()-e.reqTime<1e3&&t.TimeUtil.setServerTime(r.time),t.options.debug&&console.log("%c<<<< \u6536\u5230 [".concat(e.api,"]"),"color:#00afaf;font-weight:bold;",r),e.resp=r,[2,r]}})})},o.prototype._post=function(t,n){return __awaiter(this,void 0,void 0,function(){var r=this;return __generator(this,function(){return[2,new Promise(function(o){try{t.open("POST","".concat(r._url).concat(n.api)),t.responseType="arraybuffer",t.setRequestHeader("Content-Type","application/octet-stream"),t.setRequestHeader("Sign",n.sign),t.ontimeout=function(){t.errMsg="timeout"},t.onerror=function(e){t.errMsg=e},t.onloadend=function(){o(t)},t.send(n.reqData.buffer)}catch(e){console.error(e),o(t)}})]})})},o}(n.Client);n.HttpClient=r})(t.rpc||(t.rpc={}))}(tang||(tang={})),function(t){(function(t){t.callAPI=function(e,n){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,t.client.callAPI(e,n)]})})},t.callAPINoAuth=function(e,n){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,t.client.callAPINoAuth(e,n)]})})},t.on=function(e,n,r){t.client.on(e,n,r)},t.once=function(e,n,r){t.client.once(e,n,r)},t.off=function(e,n,r){t.client.off(e,n,r)}})(t.rpc||(t.rpc={}))}(tang||(tang={})),function(t){(function(n){var r;(function(t){t[t.ad=0]="ad",t[t.share=1]="share"})(r=n.SchemeType||(n.SchemeType={})),n.defaultSchemeParams=function(){return{newDays:3,newShareLimitHours:2,newShareLimitTimes:15,firstShareFail:!0,successTimesAfterFail:1,shareFailRate:.3,seqResetHour:6,seqNum:10,defaultSeq:[1,0,1,0,1,0,0,1,0,0]}};var o=function(){function o(){this._default={type:r.share},this._ad={type:r.ad}}return o.prototype._dateOfDayStart=function(t){var e=new Date(t);return new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime()},o.prototype._load=function(){var e=this;this._loading||(this._loading=!0,t.tool.share.getSeq({size:this._params.seqNum}).then(function(t){var n,r;e._loading=!1,t.code?(r=e._save.seq).push.apply(r,__spreadArray([],__read(e._params.defaultSeq),!1)):(n=e._save.seq).push.apply(n,__spreadArray([],__read(t.body),!1))}))},o.prototype._hours=function(t){return 36e5*t},o.prototype._next=function(n){var o=(new Date).getTime(),i=this._dateOfDayStart(o);if(!this._save){try{this._save=JSON.parse(t.localPrefs.getItem("share_ad_scheme"))}catch(e){}this._save||(this._save={})}this._save.seq=this._save.seq||[],this._save.lastShareTimes=this._save.lastShareTimes||[],this._save.forceSucTimes=~~this._save.forceSucTimes,this._save.resetTime=this._save.resetTime||i+this._hours(24),this._save.seqResetTime=this._save.seqResetTime||i+this._hours(24+this._params.seqResetHour);var a=t.createAt?(o-this._dateOfDayStart(t.createAt.getTime()))/this._hours(24):0;o>this._save.resetTime&&(this._save.resetTime=i+this._hours(24),this._save.lastShareTimes=[],this._save.forceSucTimes=0),o>this._save.seqResetTime&&(this._save.seqResetTime=i+this._hours(24+this._params.seqResetHour),this._save.seq=[]);var s=!1;if(t.userInfo&&(a<1&&t.userInfo.shareSeqGray3||a>=1&&a<3&&t.userInfo.shareSeqGray2||a>=3&&t.userInfo.shareSeqGray)&&(s=!0),!s&&a<this._params.newDays)return 0==this._save.lastShareTimes.length?this._params.firstShareFail&&a>=1?{type:r.share,forceFail:!0}:{type:r.share,forceFail:!1}:!n&&this._save.lastShareTimes.length>=this._params.newShareLimitTimes&&o-this._save.lastShareTimes[0]<this._hours(this._params.newShareLimitHours)?this._ad:this._default;this._save.seq.length<=2&&this._load();var c=0==this._save.seq.length||n?this._default:{type:this._save.seq[0]};return a>=1&&this._params.firstShareFail&&0==this._save.lastShareTimes.length&&c.type==r.share?{type:r.share,forceFail:!0}:c},o.prototype.init=function(t){this._params=t},o.prototype.next=function(o){if(void 0===o&&(o=!1),this._current)return this._current;this._params||(this._params=n.defaultSchemeParams());try{var i=this._next(o);return i.type===r.share&&(~~this._save.forceSucTimes>0?this._save.forceSucTimes--:void 0===i.forceFail&&Math.random()<this._params.shareFailRate&&(i={type:r.share,forceFail:!0}),i.forceFail&&(this._save.forceSucTimes=this._params.successTimesAfterFail)),this._current=i,i}finally{try{t.localPrefs.setItem("share_ad_scheme",JSON.stringify(this._save))}catch(e){}}},o.prototype.use=function(){if(this._params&&this._save&&this._current)try{var n=(new Date).getTime();this._current.type===r.share&&(this._save.lastShareTimes.push(n),this._save.lastShareTimes.length>this._params.newShareLimitTimes&&this._save.lastShareTimes.splice(0,this._save.lastShareTimes.length-this._params.newShareLimitTimes)),this._save.seq.length>0&&this._save.seq.shift()}finally{this._current=void 0;try{t.localPrefs.setItem("share_ad_scheme",JSON.stringify(this._save))}catch(e){}}},o}();n.scheme=new o})(t.share||(t.share={}))}(tang||(tang={})),function(t){(function(e){(e.security||(e.security={})).checkImgSec=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,t.rpc.callAPI("tool/security/checkImgSec",e)]})})}})(t.tool||(t.tool={}))}(tang||(tang={})),function(t){(function(e){(e.customerMsg||(e.customerMsg={})).delayPush=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,t.rpc.callAPI("tool/customerMsg/delayPush",e)]})})}})(t.tool||(t.tool={}))}(tang||(tang={})),function(t){(function(e){(e.share||(e.share={})).getSeq=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,t.rpc.callAPI("tool/share/getSeq",e)]})})}})(t.tool||(t.tool={}))}(tang||(tang={})),function(t){(function(e){(e.hortor||(e.hortor={})).call=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(){return[2,t.rpc.callAPI("tool/hortor/call",e)]})})}})(t.tool||(t.tool={}))}(tang||(tang={})),function(t){var e=0,n=0,r=0,o=function(){function t(){}return t.setServerTime=function(o){n||setInterval(function(){r+=1e3,Math.abs(r-t.serverTime)<2e3&&(r=n)},1e3);var i=t.serverTime;o<i&&i-o<1e3||(n=o,e=Date.now(),r=o)},Object.defineProperty(t,"serverTime",{get:function(){return n+Date.now()-e},enumerable:!1,configurable:!0}),Object.defineProperty(t,"serverTimeIsValid",{get:function(){return n>0&&Math.abs(r-t.serverTime)<1e4},enumerable:!1,configurable:!0}),t.isServerTimeValidate=function(){return t.serverTimeIsValid},t}();t.TimeUtil=o}(tang||(tang={})),function(t){(function(t){t.setItem=function(n,r){t.removeItem(n);try{localStorage.setItem(n,r)}catch(e){try{localStorage.setItem(n,r)}catch(e){}}},t.getItem=function(t){var n;try{n=localStorage.getItem(t)}catch(e){}return n},t.removeItem=function(t){try{localStorage.removeItem(t)}catch(e){}}})(t.localPrefs||(t.localPrefs={}))}(tang||(tang={})),function(t){t.lz4XorEncode=function(t){t=lz4.compress(t);for(var e=2+~~(248*Math.random()),n=Math.min(t.length,100);--n>=0;)t[n]^=e;return t[0]=112,t[1]=108,t[2]=170&t[2]|(e>>7&1)<<6|(e>>6&1)<<4|(e>>5&1)<<2|(e>>4&1)<<0,t[3]=170&t[3]|(e>>3&1)<<6|(e>>2&1)<<4|(e>>1&1)<<2|(e>>0&1)<<0,t},t.lz4XorDecode=function(t){for(var e=(t[2]>>6&1)<<7|(t[2]>>4&1)<<6|(t[2]>>2&1)<<5|(t[2]>>0&1)<<4|(t[3]>>6&1)<<3|(t[3]>>4&1)<<2|(t[3]>>2&1)<<1|(t[3]>>0&1)<<0,n=Math.min(100,t.length);--n>=2;)t[n]^=e;return t[0]=4,t[1]=34,t[2]=77,t[3]=24,lz4.decompress(t)}}(tang||(tang={})),function(t){var e=function(){function t(t,e,n){void 0===e&&(e=void 0),void 0===n&&(n=0),this._items=[],this._newFunc=t,this._freeFunc=e,this._max=n}return t.prototype.get=function(){return this._items.pop()||this._newFunc()},t.prototype.free=function(t){this._max>0&&this._items.length>=this._max||(this._freeFunc&&this._freeFunc(t),this._items.push(t))},t}();t.Pool=e}(tang||(tang={})),function(t){var e=function(){function t(t){this.mz=123456789,void 0!==t&&this.setSeed(t)}return t.prototype.setSeed=function(t){0==t&&(t=1),this.mw=t>>0,this.mz=123456789},t.prototype.random=function(t,e){if(e<=t)throw new Error("max must > min");this.mz=36969*(65535&this.mz)+(this.mz>>16),this.mw=18e3*(65535&this.mw)+(this.mw>>16);var n=(this.mz<<16)+this.mw;return t+(n&=2147483647)%(e-t>>0)},t.prototype.next=function(){return this.random(0,1e4)/1e4},t}();t.SeedRandom=e}(tang||(tang={})),function(t){t.sleep=function(t){return new Promise(function(e){setTimeout(e,t)})}}(tang||(tang={})),function(t){var e=function(){function t(){this.states={},this.nextState=void 0}return t.prototype.register=function(t,e,n,r){this.registerState({state:t,enter:e,exit:n,update:r})},t.prototype.registerState=function(t){this.states[t.state]=t},t.prototype.changeStateNextFrame=function(t){this.nextState=t},t.prototype.changeState=function(t){this.state&&this.state.exit&&this.state.exit(),this.preState=this.curState,this.curState=t,this.state=this.states[t],this.firstUpdate=!0,this.state&&this.state.enter&&this.state.enter()},t.prototype.update=function(){void 0!==this.nextState&&(this.changeState(this.nextState),this.nextState=void 0),this.state&&this.state.update&&this.state.update(),this.firstUpdate=!1},t}();t.StateMachine=e}(tang||(tang={})),function(t){t.isArrayLike=function(t){return window.isArrayLike&&window.isArrayLike(t)||t instanceof Array},t.isMapLike=function(t){return window.isObservableMap&&window.isObservableMap(t)||t instanceof Map}}(tang||(tang={})),function(t){(function(t){t.start=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(n){switch(n.label){case 0:return t.client?t.client.reset(e):t.client=new t.WebSocketClient(e),[4,t.client.connect()];case 1:return n.sent(),[2]}})})},t.end=function(){t.client&&t.client.reset()};var e,n,r={};t.executeCallback=function(t){var o=r[t.cmd];if(o&&o.length){for(n=t.cmd,e=0;e<o.length;++e)o[e].callback.call(o[e].thisObj,t);e=void 0,n=void 0}},t.sendAsync=function(e){return e.hint&&(e.cmd+="/"+e.hint),t.client.sendAsync(e)},t.send=function(e){e.hint&&(e.cmd+="/"+e.hint),t.client.send(e)},t.on=function(t,e,n){r[t]||(r[t]=[]),r[t].push({callback:e,thisObj:n})},t.off=function(t,o,i){if(r[t])for(var a=r[t],s=0;s<a.length;++s)if(a[s].callback===o&&a[s].thisObj===i)return a.splice(s,1),void(n&&n===t&&s<=e&&e--)}})(t.ws||(t.ws={}))}(tang||(tang={})),function(t){var n;(function(r){var o,i=window.requestAnimationFrame||function(t){return setTimeout(t,16)};(function(t){t[t.Idle=0]="Idle",t[t.Connecting=1]="Connecting",t[t.Running=2]="Running",t[t.Reconnecting=3]="Reconnecting",t[t.Error=4]="Error"})(o||(o={}));var a,s=function(){function t(){this._arr=[],this._idx=0,this.seq=0}return Object.defineProperty(t.prototype,"length",{get:function(){return this._arr.length-this._idx},enumerable:!1,configurable:!0}),t.prototype.enqueue=function(t){this._arr.push(t)},t.prototype.dequeue=function(){if(!(this._idx>=this._arr.length))return this._arr[this._idx++]},t.prototype.confirm=function(t){var e=this._arr.length-this.seq+t-1;e>=this._idx&&(e=this._idx-1),e<0||(this._arr.splice(0,e+1),this._idx-=e+1)},t.prototype.restore=function(){this._idx=0},t}(),c=function(){function t(){this._arr=[],this._seq=0}return Object.defineProperty(t.prototype,"seq",{get:function(){return this._seq},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"length",{get:function(){return this._arr.length},enumerable:!1,configurable:!0}),t.prototype.enqueue=function(t){if(~~t.seq>0){if(t.seq<=this._seq)return;if(t.seq>this._seq+1)throw new Error("over seq: "+t);this._seq=t.seq}this._arr.push(t)},t.prototype.dequeue=function(){if(0!==this._arr.length)return this._arr.shift()},t}(),u=function(){function t(){this._last=this._now=Date.now()}return t.prototype.update=function(){var t=Date.now();this._now+=Math.min(t-this._last,100),this._last=t},Object.defineProperty(t.prototype,"now",{get:function(){return this._now},enumerable:!1,configurable:!0}),t}();(function(t){t.lx="lx",t.none="none"})(a=r.WSEncoding||(r.WSEncoding={}));var h=function(){function h(e){var n=this;this._destroyed=!1,window.ws=this,this._config={heartbeatInterval:5e3,connectionTimeoutTime:1e4,encoding:a.lx},this._sm=new t.StateMachine,this._sm.registerState({state:o.Running,enter:function(){return n.onRunningEnter()},update:function(){return n.onRunningUpdate()}}),this._sm.registerState({state:o.Connecting,enter:function(){return n.onConnectingEnter()},update:function(){return n.onConnectingUpdate()}}),this._sm.registerState({state:o.Reconnecting,enter:function(){return n.onReconnectingEnter()},update:function(){return n.onReconnectingUpdate()}}),this._sm.registerState({state:o.Error,enter:function(){return n.onErrorEnter()}}),this._sm.changeState(o.Idle),this._frameTimer=new u,this.reset(e),i(function(){return n.update()})}return h.prototype.reset=function(t){if(!this._destroyed){if(this.cleanData(),t)for(var e in t)this._config[e]=t[e];this._sm.changeState(o.Idle)}},h.prototype.destroy=function(){this._destroyed=!0,this._connParam.sessionToken=void 0,this.cleanData(),n.executeCallback({cmd:r.CMD.SYS_CLOSED})},h.prototype.getAndUseAck=function(){var t=this._ack;return this._ack=0,t},h.prototype.connect=function(){return __awaiter(this,void 0,void 0,function(){var e,n=this;return __generator(this,function(){if(this._sm.curState!=o.Idle)throw new Error("state error");return this._url=t.options.urlRoot.replace("http://","ws://").replace("https://","wss://")+"agent/ws",e=new Promise(function(t){n._connResolve=t}),this._sm.changeStateNextFrame(o.Connecting),[2,e]})})},h.prototype.onConnectingEnter=function(){t.options.debug&&console.log("~~~~~~~~~onConnectingEnter"),this.cleanWS(),this._tryConnectTimeoutTotal=this._frameTimer.now+1e4,this._tryConnectTimeoutOnce=-1,this._ws=void 0,this._connParam.isRestore=0,this._nextTryConnectTime=1,this._tryConnectTimes=0},h.prototype.onConnectingUpdate=function(){this.tryConnect()},h.prototype.tryConnect=function(){var e=this,n=this._frameTimer.now;if(this._tryConnectTimeoutTotal>0&&n>this._tryConnectTimeoutTotal)return this._tryConnectTimeoutTotal=-1,void this._sm.changeState(o.Error);if(this._tryConnectTimeoutOnce>0&&n>this._tryConnectTimeoutOnce&&(this._tryConnectTimeoutOnce=-1,this.cleanWS(),this._nextTryConnectTime=n+100,this._ws=void 0),this._nextTryConnectTime>0&&n>this._nextTryConnectTime){this._tryConnectTimes++,this._nextTryConnectTime=-1,this._tryConnectTimeoutOnce=n+3e3,this.cleanWS(),this._connParam.connToken=""+Date.now();var r=JSON.stringify(this._connParam),i=md5.create();i.update(r),i.update(t.options.secret);var a=i.hex(),s="".concat(this._url,"?p=").concat(encodeURIComponent(r),"&sign=").concat(a,"&e=").concat(this._config.encoding),c=new WebSocket(s);this._ws=c,c.binaryType="arraybuffer",c.onopen=function(){e._sm.changeState(o.Running)},c.onclose=c.onerror=function(){e._nextTryConnectTime=n+100},c.onmessage=function(t){e.addResp(t.data)}}},h.prototype.send=function(e){if(!this._destroyed&&this._sm.curState!=o.Error){var n={body:bon.encode(e.body),ack:this.getAndUseAck(),cmd:e.cmd,seq:++this._sndQueue.seq,time:Date.now()};t.options.debug&&console.log("ws enqueue : "+JSON.stringify(e));var r=this.encodeMsg(n);return this._sndQueue.enqueue(r),this._sm.curState===o.Running&&this.onRunningUpdate(),n}},h.prototype.sendAsync=function(e){var n=this.send(e);if(!n)return Promise.resolve({code:t.rpc.ErrorCode.CANCELED,error:"offline"});var r={msg:n,resolve:null},o=new Promise(function(t){return r.resolve=t});return this._asyncList.push(r),o},h.prototype.update=function(){var t=this;this._destroyed||(this._frameTimer.update(),this._sm.update(),i(function(){return t.update()}))},h.prototype.resetHeartbeatTime=function(){var t=Date.now();this._nextHeartbeatTime=t+this._config.heartbeatInterval},h.prototype.resetConnectionTimeout=function(){var t=this._frameTimer.now;this._connectionTimeout=t+this._config.connectionTimeoutTime},h.prototype.onRunningEnter=function(){var e=this;t.options.debug&&console.log("~~~~~~~~~onRunningEnter"),this._connResolve&&(this._connResolve(!0),this._connResolve=void 0),this._sndQueue.restore(),this.resetHeartbeatTime(),this.resetConnectionTimeout();var n=this._ws;n.onmessage=function(t){n===e._ws&&e.addResp(t.data)},n.onerror=n.onclose=function(){n===e._ws&&e._sm.changeStateNextFrame(o.Reconnecting)}},h.prototype.addResp=function(n){this.resetConnectionTimeout();try{var r=new Uint8Array(n);if(r.length<=1)return;var i=this.decodeMsg(r);switch(~~i.ack>0&&this._sndQueue.confirm(~~i.ack),i.seq&&(this._ack=i.seq),i.cmd){case"_sys/ack":return;case"_sys/error":try{console.log(bon.decode(i.body))}catch(e){}return void this._sm.changeStateNextFrame(o.Reconnecting);case"_sys/fatal":try{console.log(bon.decode(i.body))}catch(e){}return void this._sm.changeState(o.Error);default:return void this._recQueue.enqueue(i)}}catch(e){t.options.debug&&console.log(e),this._sm.changeStateNextFrame(o.Reconnecting)}},h.prototype.onRunningUpdate=function(){var r=Date.now(),i=this._sm;if(this._frameTimer.now>this._connectionTimeout)i.changeStateNextFrame(o.Reconnecting);else{r>this._nextHeartbeatTime&&this.sendHeartbeat();for(var a=0;this._sndQueue.length>0&&a++<10&&void 0===i.nextState;){var s=this._sndQueue.dequeue();this.wsSend(s.buffer.slice(0,s.length))}for(a=0;this._recQueue.length>0&&a++<10;){s=this._recQueue.dequeue();try{if(s.decBody=s.body&&bon.decode(s.body),s.body=void 0,s.code=~~s.code,t.options.debug&&console.log("ws recieve : "+JSON.stringify(s)),n.executeCallback(s),~~s.resp>0)for(;this._asyncList.length>0;){var c=this._asyncList[0];if(s.resp==c.msg.seq){s.time&&Date.now()-c.msg.time<500&&t.TimeUtil.setServerTime(s.time),c.resolve(s),this._asyncList.splice(0,1);break}if(s.resp<c.msg.seq)break;s.resp>c.msg.seq&&(t.options.debug&&console.warn(c.msg.cmd+" has no response, use send instead"),c.resolve({code:t.rpc.ErrorCode.SKIP}),this._asyncList.splice(0,1))}if(s.code<0)return void i.changeState(o.Error)}catch(e){console.error(e),this._sm.changeStateNextFrame(o.Reconnecting);break}}}},h.prototype.encodeMsg=function(e){var n=bon.encode(e);return t.lz4XorEncode(n)},h.prototype.decodeMsg=function(e){return e.length>4&&112==e[0]&&108==e[1]&&(e=t.lz4XorDecode(e)),bon.decode(e)},h.prototype.sendHeartbeat=function(){this.resetHeartbeatTime();var e=this.getAndUseAck();if(t.options.debug&&console.log("~~~~~~~~~sendHeartbeat",e),0==e)this.wsSend(new ArrayBuffer(1));else{var n={ack:e,cmd:"_sys/ack",time:Date.now()},r=this.encodeMsg(n);this.wsSend(r.buffer.slice(0,r.length))}},h.prototype.wsSend=function(t){var n=this._ws,r=this._sm;if(1==n.readyState)try{n.send(t)}catch(e){r.changeStateNextFrame(o.Reconnecting),console.error(e)}else r.changeStateNextFrame(o.Reconnecting)},h.prototype.onReconnectingEnter=function(){t.options.debug&&console.log("~~~~~~~~~onReconnectingEnter"),this.cleanWS(),this._tryConnectTimeoutTotal=this._frameTimer.now+1e4,this._tryConnectTimeoutOnce=-1,this._connParam.isRestore=1,this._nextTryConnectTime=1,this._tryConnectTimes=0},h.prototype.onReconnectingUpdate=function(){this.tryConnect()},h.prototype.cleanWS=function(){this._ws&&(this._ws.onerror=this._ws.onclose=this._ws.onmessage=this._ws.onopen=void 0,this._ws.close(),this._ws=void 0)},h.prototype.cleanData=function(){this.cleanWS(),this._connResolve&&(this._connResolve(!1),this._connResolve=void 0),this._sndQueue=new s,this._asyncList&&this._asyncList.forEach(function(e){e.resolve({code:t.rpc.ErrorCode.CANCELED})}),this._asyncList=[],this._recQueue=new c,this._connParam={playerId:t.playerId,gameId:t.options.gameId,playerToken:t.rpc.client.token,sessionToken:Date.now()+"",connToken:"",isRestore:0},this._ack=0},h.prototype.onErrorEnter=function(){t.options.debug&&console.log("~~~~~~~~~onErrorEnter"),this.cleanData(),n.executeCallback({cmd:r.CMD.SYS_CLOSED})},h}();r.WebSocketClient=h})(n=t.ws||(t.ws={}))}(tang||(tang={})),function(t){(function(e){(function(e){e.SYS_CLOSED="_sys/closed",e.TEAM_CREATE=t.OBE.team.CMDS.create,e.MATCH_START=t.OBE.team.CMDS.matchStart,e.MATCH_CANCEL=t.OBE.team.CMDS.matchCancel,e.MARCH_TIMEOUT=t.OBE.team.RESPS.matchTimeout,e.ROOM_START=t.OBE.room.RESPS.start,e.ROOM_END=t.OBE.room.CMDS.end,e.ROOM_MSG=t.OBE.room.CMDS.msg,e.ROOM_CREATE=t.OBE.room.CMDS.create,e.ROOM_JOIN=t.OBE.room.CMDS.join,e.ROOM_LOCK=t.OBE.room.CMDS.lock,e.ROOM_UNLOCK=t.OBE.room.CMDS.unlock,e.ROOM_DISMISS=t.OBE.room.CMDS.dismiss,e.ROOM_LEAVE=t.OBE.room.CMDS.leave,e.ROOM_REG_TIMER=t.OBE.room.CMDS.regTimer,e.ROOM_TIMER_FIRE=t.OBE.room.RESPS.timerFire,e.ROOM_UPDATE_CUSTOM=t.OBE.room.CMDS.updateCustom,e.ROOM_UPDATE_MEMBER_INFO=t.OBE.room.CMDS.updateMemberInfo,e.ROOM_START_FRAME_SYNC=t.OBE.room.CMDS.startFrameSync,e.ROOM_STOP_FRAME_SYNC=t.OBE.room.CMDS.stopFrameSync,e.ROOM_FRAME_MSG=t.OBE.room.CMDS.frameMsg})(e.CMD||(e.CMD={}))})(t.ws||(t.ws={}))}(tang||(tang={}));